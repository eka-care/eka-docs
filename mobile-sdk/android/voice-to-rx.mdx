### Github Repo

[Voice2Rx](https://github.com/eka-care/eka-v2rx-android/tree/voice2rx_sdk)

### Dependency inclusion in app/build.gradle.kts

```kotlin
implementation("com.github.eka-care:eka-v2rx-android:1.0.5")
```

### Initialise SDK

```kotlin
// Create object which is implementing OkHttpSetUp interface 
// to provide auth tokens

class OkHttpImpl : IOkHttpSetup {
		// provide headers which are necessary here
		override fun getDefaultHeaders(url: String): Map<String, String> {
				val headers = HashMap<String, String>()
        headers["auth"] = // provide session token here for authentication
    }

    override fun refreshAuthToken(url: String): Map<String, String>? {
	      // refresh auth token here
    }

    override fun onSessionExpire() {
		    // refresh token expired
    }
}

Voice2Rx.init(
    context = context,
    config = Voice2RxInitConfig(
        onStart = {

        },
        onStop = { sessionId, recordedFiles ->

        },
        onError = { sessionId, errorMsg ->

        },
        docOid = "",
        docUuid = "",
        ownerId = "",
        contextData = ContextData(doctor = null, patient = null, visitid = sessionId),
        okHttpSetup = OkHttpImpl(),
        callerId = "",
    )
)

```

### Start Voice Session

```kotlin
// Here any mode can be passed which are specified in SDK
Voice2Rx.startVoice2Rx(mode = Voice2RxType.DICTATION)
// After starting session you will get callback in onStart function 
// which is passed in init function
```

### Stop Voice Session

```kotlin
// After stopping the session 
// onStop callback will be delivered with sessionId which is passed in init function
Voice2Rx.stopVoice2Rx()
```

### Check session is currently running

```kotlin
// It will return true if session is going on
Voice2Rx.isCurrentlyRecording()
```

### Get all sessions history

```kotlin
// It will return list of sessions taken 
val sessions = Voice2Rx.getSessions()
// access any session from the list for e.g below is taken the first element
val session = sessions.first()
// Can access transcript and structured rx in the session object
// Sample responses for both values given below
val transcript = session.transcript
val structuredRx = session.structuredRx
```

### Sample parsed data in structured rx

```kotlin
{
  "prescription": {
    "advices": [
      {
        "id": "locale-4f1e59b7c71003546b7bb5aadb89280b",
        "parsedText": "Take bedrest for at least 7 days",
        "text": "Take bedrest for at least 7 days"
      },
      {
        "id": "locale-b3ca8e9447de58b3738549ec3c8db922",
        "parsedText": "Do exercise with physiotherapist",
        "text": "Do exercise with physiotherapist"
      }
    ],
    "followup": {
      "date": "2025-03-09T00:00:00.000000Z"
    },
    "labTests": [
      {
        "common_name": "Blood sugar test",
        "id": "locale-5686e09a70ffcbc355b372f57b744752",
        "name": "Blood sugar test"
      },
      {
        "common_name": "Liver function test",
        "id": "locale-9b501b45359316407782679ce7eeabac",
        "name": "Liver function test"
      },
      {
        "common_name": "X-ray",
        "id": "locale-3c51a99d9bbfefde7ba517f3316899f2",
        "name": "X-ray"
      }
    ],
    "language": "EN",
    "medications": [
      {
        "duration": {
          "custom": "3 Days",
          "unit": "Days",
          "value": 3
        },
        "frequency": {
          "custom": "1-1-1",
          "dose": [
            "1",
            "1",
            "1"
          ],
          "frequency": "3",
          "pattern_id": "fp-1",
          "period": 1,
          "period_unit": "day"
        },
        "id": "locale-a0fdc63d09d1d255b00796ade40bb3c6",
        "name": "Molo 650 tablet",
        "original_name": "mdolo 650 tablet",
        "linked": {
          "eka_id": "b-4974923412"
        }
      }
    ],
    "symptoms": [
      {
        "id": "locale-f532fde6e2a357af72b9de6aa1f0e65e",
        "name": "Fever",
        "status": "preliminary"
      },
      {
        "id": "locale-6a44898c82426d50cb083373d59b155a",
        "name": "Headache",
        "status": "preliminary"
      },
      {
        "id": "locale-867fc9a3c94474b3c77ee9a0b5aae022",
        "name": "Leg pain",
        "status": "preliminary"
      },
      {
        "id": "locale-a7033cb31b1991cc8f4c9c751a8452b6",
        "name": "Neck pain",
        "status": "preliminary"
      }
    ]
  }
}
```

### Sample parsed data in markdown format

```markdown
**Chief Complaints**
- Fever
- Headache
- Leg pain
- Neck pain

**Assessment**
- Symptomatic fever with multiple body pains

**Plan**
- Medications:
  - Mdolo 650 tablet - TID for 3 days
- Investigations advised:
  - Blood test
  - Blood sugar test
  - Liver function test
  - X-ray
- Physiotherapy referral

**Patient Instructions**
- Take complete bed rest for 7 days
- Follow up after 15 days with all investigation reports
- Continue physiotherapy sessions
- Take prescribed medications as directed
```

### For Retry the session

```kotlin
Voice2Rx.retrySession(
    context = context,
    sessionId = sessionId,
    onResponse = { responseState -> 
        // here you will get callback regarding retry was successful or not
    },
)
```

### After all the process completion

```kotlin
// Free up the resources using below function
Voice2Rx.dispose()
```